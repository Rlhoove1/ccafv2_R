---
title: "Predict_Cell_Cycle_for_scRNA_seq"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Predict_Cell_Cycle_for_scRNA_seq}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```
devtools::install_github("plaisier-lab/ccafv2_R/ccAFv2")
```


```{r setup}
library(ccAFv2)

library("org.Hs.eg.db")

library(Seurat)

# Load up U5 expression
U5_seurat = readRDS('data/U5_normalized_ensembl_041723.rds')

s.genes = na.omit(unlist(mapIds(org.Hs.eg.db, keys = cc.genes$s.genes, keytype = "SYMBOL", column="ENSEMBL", multiVals='first')))
g2m.genes = na.omit(unlist(mapIds(org.Hs.eg.db, keys = cc.genes$g2m.genes, keytype = "SYMBOL", column="ENSEMBL", multiVals='first')))

# Seurat cell cycle scoring method
U5_seurat = CellCycleScoring(U5_seurat, s.features = s.genes, g2m.features = g2m.genes, set.ident = TRUE)

# ccAFv2 cell cycle prediction method
U5_seurat = PredictCellCycle(U5_seurat)

# view cell cycle scores and phase assignments
head(marrow[[]])
```


